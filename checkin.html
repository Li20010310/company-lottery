<!DOCTYPE html>
<html>
<head>
    <title>æˆæœå±•ç­¾åˆ° - å‚ä¸æŠ½å¥–</title>
    <style>
        /* æ ·å¼åŒä¸Šï¼Œçœç•¥ä»¥èŠ‚çœç©ºé—´ */
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ‰ æˆæœå±•æŠ½å¥–ç­¾åˆ° ğŸ‰</h1>
        <p>è¯·æ‰«ç ç­¾åˆ°ï¼Œå³å¯å‚ä¸æŠ½å¥–æ´»åŠ¨</p>
        <div class="qrcode">
            <!-- å¤‡ç”¨äºŒç»´ç æ˜¾ç¤ºåŒºåŸŸ -->
            <div id="qrcodeContainer">
                <canvas id="qrcodeCanvas" width="180" height="180"></canvas>
                <p id="qrcodeFallback" style="display:none; color:red;">
                    äºŒç»´ç åŠ è½½ä¸­...<br>
                    è¯·æ‰‹åŠ¨è¾“å…¥ç½‘å€æˆ–åˆ·æ–°é¡µé¢
                </p>
            </div>
        </div>
        <p>æˆ–ç›´æ¥è¾“å…¥å§“åï¼š</p>
        <input type="text" id="name" placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å">
        <button onclick="signIn()">ç¡®è®¤ç­¾åˆ°</button>
        <div id="message"></div>
    </div>
    
    <script>
        // ç®€å•çš„äºŒç»´ç ç”Ÿæˆå‡½æ•°ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function generateSimpleQRCode() {
            const canvas = document.getElementById('qrcodeCanvas');
            const ctx = canvas.getContext('2d');
            const url = window.location.href;
            
            // æ¸…é™¤ç”»å¸ƒ
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, 180, 180);
            
            // ç”Ÿæˆç®€å•çš„äºŒç»´ç æ ·å¼ï¼ˆå®é™…ä½¿ç”¨åº”ä½¿ç”¨å®Œæ•´ç®—æ³•ï¼‰
            // è¿™é‡Œç®€åŒ–å¤„ç†ï¼šæ˜¾ç¤ºURLå’Œæç¤º
            ctx.fillStyle = 'black';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('æ‰«ææ­¤äºŒç»´ç ', 90, 80);
            ctx.font = '10px Arial';
            ctx.fillText('æˆ–è®¿é—®ï¼š', 90, 100);
            ctx.font = '8px Arial';
            
            // æ˜¾ç¤ºç¼©çŸ­çš„URL
            let displayUrl = url;
            if (displayUrl.length > 30) {
                displayUrl = displayUrl.substring(0, 27) + '...';
            }
            ctx.fillText(displayUrl, 90, 115);
            
            // ç»˜åˆ¶è¾¹æ¡†å’Œæç¤º
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.strokeRect(10, 10, 160, 160);
            
            ctx.fillStyle = '#666';
            ctx.font = 'bold 14px Arial';
            ctx.fillText('ğŸ“±', 90, 150);
        }
        
        // ä½¿ç”¨å¤–éƒ¨åº“ç”Ÿæˆé«˜è´¨é‡äºŒç»´ç 
        function loadQRCodeLibrary() {
            // åŠ¨æ€åŠ è½½ QRCode.js
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js';
            script.onload = function() {
                if (typeof QRCode !== 'undefined') {
                    generateRealQRCode();
                } else {
                    generateSimpleQRCode();
                }
            };
            script.onerror = function() {
                generateSimpleQRCode();
            };
            document.head.appendChild(script);
        }
        
        // ä½¿ç”¨çœŸæ­£çš„äºŒç»´ç åº“
        function generateRealQRCode() {
            try {
                const pageUrl = window.location.href;
                QRCode.toCanvas(
                    document.getElementById('qrcodeCanvas'),
                    pageUrl,
                    { width: 180, margin: 1 },
                    function(error) {
                        if (error) {
                            console.error('äºŒç»´ç ç”Ÿæˆå¤±è´¥:', error);
                            generateSimpleQRCode();
                        }
                    }
                );
            } catch (e) {
                generateSimpleQRCode();
            }
        }
        
        // é¡µé¢åŠ è½½
        window.onload = function() {
            // å°è¯•åŠ è½½å¤–éƒ¨åº“ç”ŸæˆäºŒç»´ç 
            loadQRCodeLibrary();
            
            // ç­¾åˆ°åŠŸèƒ½ï¼ˆåŒä¸Šï¼‰
            // ...
        };
        
        // ç­¾åˆ°åŠŸèƒ½ï¼ˆä¸æ–¹æ¡ˆä¸€ç›¸åŒï¼Œæ­¤å¤„çœç•¥ï¼‰
    </script>
</body>
</html>
